% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_etalab_data.R
\name{get_etalab_data}
\alias{get_etalab_data}
\title{Download and read cadastre data from Etalab for one or several INSEE codes}
\usage{
get_etalab_data(
  insee_code,
  data = NULL,
  extract_dir = NULL,
  overwrite = TRUE,
  verbose = TRUE,
  ...
)
}
\arguments{
\item{insee_code}{\code{character} or \code{numeric}
One or more INSEE codes for the communes or administrative units to download cadastre data for.}

\item{data}{\code{character}, \code{list} of \code{character}, or \code{NULL}
Specific datasets to download.
\itemize{
\item If \code{NULL} (default), all available datasets are retrieved.
\item If a character vector, the same datasets are retrieved for all \code{insee_code}s.
\item If a list of character vectors, it must have the same length as \code{insee_code},
with each element specifying datasets for the corresponding code.
}

Valid dataset names are taken from \code{\link[=cfg_get_data]{cfg_get_data()}}, including both
\code{raw_data} (e.g. \code{"parcelle"}, \code{"numvoie"}) and \code{proc_data}
(e.g. \code{"parcelles"}, \code{"sections"}). An error is raised if an invalid name is provided.}

\item{extract_dir}{\code{character} or \code{NULL}
Path to the directory where downloaded files should be extracted.
If \code{NULL}, a unique temporary directory is created automatically.}

\item{overwrite}{\code{logical} (default: \code{TRUE})
Whether to overwrite existing files in \code{extract_dir}.}

\item{verbose}{\code{logical} (default: \code{TRUE})
If \code{TRUE}, warnings about missing URLs or failed downloads are displayed.
If \code{FALSE}, the function fails silently and returns \code{NULL} when issues occur.}

\item{...}{Additional arguments passed to \code{\link[=etalab_get_data_urls]{etalab_get_data_urls()}}.}
}
\value{
A named list of \code{sf} objects containing the downloaded and read cadastre datasets.
Each list element corresponds to a dataset (e.g., \code{"parcelle"}, \code{"numvoie"}).
If multiple files correspond to the same dataset, they are combined and returned
as a single \code{sf} object with unified columns.
}
\description{
This function retrieves URLs for cadastre datasets from Etalab based on
one or several INSEE codes and optional dataset filters. It downloads and
extracts the data into a specified directory, then reads all extracted
GeoJSON files as \code{sf} objects. When multiple files correspond to the same
dataset, their contents are aggregated into a single \code{sf} object with
harmonized columns. The result is returned as a named list of \code{sf} objects.
}
\details{
The function follows these steps:
\enumerate{
\item Validate and normalize the \code{data} argument (see \strong{Details} above).
\item Retrieve the list of download URLs from Etalab using \code{\link[=etalab_get_data_urls]{etalab_get_data_urls()}}.
\item Download and extract the files into \code{extract_dir} using \code{\link[=cdg_download_archives]{cdg_download_archives()}}.
\item Read all extracted GeoJSON files with \code{\link[=read_geojson]{read_geojson()}}, which aggregates them
by dataset name and ensures consistent column structure across files.
}

If \code{extract_dir} is not provided, a unique temporary directory is created
(\code{tempfile(pattern = "cadastre_extract_")}). This prevents conflicts
between multiple calls and keeps downloaded data isolated.
}
\examples{
\dontrun{
# Download and read all datasets for one INSEE code
cadastre_data <- get_etalab_data("72188")

# Download only parcelle and numvoie datasets, with a fixed extraction directory
cadastre_data <- get_etalab_data(
  "72188",
  data = c("parcelle", "numvoie"),
  extract_dir = "data/cadastre"
)

# Different datasets per INSEE code
cadastre_data <- get_etalab_data(
  c("72187", "72188"),
  data = list(c("parcelle"), c("parcelle", "batiment"))
)
}

}
